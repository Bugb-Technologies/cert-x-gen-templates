id: auth-bypass-flow
name: "Authentication Bypass with Session Flow"
author:
  name: "CERT-X-GEN Security Team"
  email: "security@cert-x-gen.io"
severity: critical
description: |
  Tests for authentication bypass vulnerabilities using multi-step flows.
  Attempts to access protected resources without proper authentication.

tags:
  - authentication
  - authorization
  - bypass
  - owasp-a01
  - access-control
  - web

language: yaml
confidence: 90

cwe:
  - CWE-287

references:
  - https://cwe.mitre.org/data/definitions/287.html
  - https://owasp.org/www-community/attacks/Bypassing_Authentication
  - https://portswigger.net/web-security/authentication

# Multi-step flow execution
flows:
  - name: baseline_check
    description: "Check if admin panel is directly accessible"
    steps:
      - action: http_request
        method: GET
        path: /admin
        matchers:
          - type: status
            status: [200]
          - type: word
            words: ["admin", "dashboard", "control panel"]
            condition: or
    
  - name: path_traversal_bypass
    description: "Try path traversal to bypass auth"
    steps:
      - action: http_request
        method: GET
        path: /../admin
      - action: http_request
        method: GET
        path: /admin/..;/admin
      - action: http_request
        method: GET
        path: /admin%2f..%2fadmin
        matchers:
          - type: status
            status: [200]
  
  - name: verb_tampering
    description: "Test HTTP verb tampering"
    steps:
      - action: http_request
        method: POST
        path: /admin
      - action: http_request
        method: PUT
        path: /admin
      - action: http_request
        method: DELETE
        path: /admin
        matchers:
          - type: status
            status: [200, 201, 204]
  
  - name: header_manipulation
    description: "Test authentication header bypass"
    steps:
      - action: http_request
        method: GET
        path: /admin
        headers:
          X-Forwarded-For: "127.0.0.1"
          X-Original-URL: "/admin"
          X-Rewrite-URL: "/admin"
        matchers:
          - type: status
            status: [200]
          - type: word
            words: ["admin", "unauthorized"]
            condition: or
