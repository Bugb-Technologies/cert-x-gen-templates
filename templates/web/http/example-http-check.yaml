# Example HTTP Security Check Template
# This is a sample YAML template demonstrating the template structure
#
# PROTOCOL FLEXIBILITY:
# - This template uses 'http:' section, which automatically supports BOTH HTTP and HTTPS
# - No need to specify protocol explicitly - the engine will try both schemes
# - Port-aware: 443 → tries HTTPS first, 80 → tries HTTP first
# - Stops after first successful detection

id: example-http-check
name: "Example HTTP Security Check"
author:
  name: "CERT-X-GEN Security Team"
  email: "security@cert-x-gen.io"

severity: info
description: |
  This is an example template that demonstrates how to create YAML-based
  security checks for HTTP services. Use this as a reference for building
  custom security detection templates.
  
  This template automatically works with both HTTP and HTTPS protocols.

tags:
  - example
  - http
  - demo
  - template
  - documentation

language: yaml
confidence: 100

cwe:
  - CWE-1008

references:
  - https://cwe.mitre.org/data/definitions/1008.html
  - https://github.com/cert-x-gen/templates
  - https://docs.cert-x-gen.io/templates

metadata:
  created: 2024-01-15
  updated: 2024-01-15
  version: "1.0"
  confidence: high
  false-positive-rate: low

template:
  timeout: 10s
  max-redirects: 3

# HTTP request specifications
http:
  - method: GET
    path:
      - "/"
      - "/index.html"
    
    headers:
      User-Agent: "cert-x-gen/1.0"
    
    # Matchers define what constitutes a vulnerability
    matchers-condition: and
    matchers:
      # Check HTTP status code
      - type: status
        status:
          - 200
          - 301
          - 302
      
      # Check for specific words in response
      - type: word
        words:
          - "Server"
        part: header
        condition: or
    
    # Extractors pull data from responses
    extractors:
      - type: regex
        name: server_version
        regex:
          - "Server: ([\\w/\\.]+)"
        group: 1
        part: header

# Additional template configurations
flows:
  - name: detection
    steps:
      - action: http_request
        method: GET
        path: /

remediation: |
  This is an example template for demonstration purposes.
  No remediation is required.

references:
  - https://cert-x-gen.io/docs/templates
  - https://github.com/cert-x-gen/templates
