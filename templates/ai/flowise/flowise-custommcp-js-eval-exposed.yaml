# CERT-X-GEN YAML Template

id: flowise-custommcp-js-eval-exposed
name: "Flowise CustomMCP JS Eval Endpoint Exposed"
author:
  name: "CERT-X-GEN Security Team"
  email: "security@cert-x-gen.local"
severity: critical
description: |
  Detects an exposed Flowise CustomMCP endpoint that evaluates user-supplied
  mcpServerConfig strings. Vulnerable Flowise versions evaluate the string
  via Function('return ' + input)(), enabling remote code execution
  (CVE-2025-59528).

tags:
  - flowise
  - mcp
  - custommcp
  - rce
  - deserialization
  - eval
  - cve-2025-59528

language: yaml
confidence: 85

cve_ids:
  - "CVE-2025-59528"
cwe_ids:
  - "CWE-94"   # Code Injection
  - "CWE-306"  # Missing Authentication for Critical Function
cvss_score: 9.8
version: "1.0.0"

references:
  - https://github.com/advisories/GHSA-3gcm-f6qx-ff7p
  - https://research.jfrog.com/vulnerabilities/flowise-os-command-remote-code-execution-jfsa-2025-001380578

http:
  - method: POST
    path:
      - "/api/v1/node-load-method/customMCP"

    headers:
      User-Agent: "cert-x-gen/1.0"
      Content-Type: "application/json"

    body: |
      {
        "loadMethod": "listActions",
        "inputs": {
          "mcpServerConfig": "({})"
        }
      }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "application/json"
        part: header

      - type: word
        words:
          - "actions"
          - "listActions"
          - "customMCP"
        condition: or
        part: body

    extractors:
      - type: regex
        name: action_names
        regex:
          - "\"name\"\\s*:\\s*\"([^\"]+)\""
        group: 1

remediation: |
  1. Upgrade Flowise to a version with patched CustomMCP handling.
  2. Require authentication/authorization for the CustomMCP endpoints.
  3. Disable CustomMCP if not required in production.
  4. Audit API tokens and restrict access to trusted networks.
