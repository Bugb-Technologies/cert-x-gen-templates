id: exposed-ollama-api-version
name: "Exposed Ollama API Version Endpoint"
author:
  name: "CERT-X-GEN Automated Generator"
  email: "noreply@cert-x-gen.local"
  github: "cert-x-gen"
severity: medium
description: |
  Detects an exposed Ollama API endpoint by sending a GET request to /api/version.
  If the endpoint responds with a valid JSON object containing a version field,
  it indicates that the Ollama API is accessible without authentication.
  This could allow unauthorized users to interact with the service.

tags:
  - ollama
  - unauth
  - exposed
  - api

language: yaml
confidence: 95

cve_ids: []
cwe_ids:
  - "CWE-200"
cvss_score: 5.3
version: "1.0.0"

references:
  - https://ollama.ai/
  - https://owasp.org/www-community/attacks/Exposed_Information

http:
  - method: GET
    path:
      - "/api/version"

    headers:
      User-Agent: "cert-x-gen/1.0"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        regex:
          - '"version"\s*:\s*"[0-9]+\.[0-9]+\.[0-9]+"'
        part: body

      - type: word
        words:
          - "application/json"
        part: header

    extractors:
      - type: regex
        name: ollama_version
        regex:
          - '"version"\s*:\s*"([0-9]+\.[0-9]+\.[0-9]+)"'

remediation: |
  1. Restrict access to the Ollama API endpoints to authorized users only.
  2. Implement authentication and authorization controls for all API routes.
  3. Avoid exposing internal API endpoints like /api/version to the public internet.
  4. Review firewall and reverse proxy configurations to ensure proper access control.
